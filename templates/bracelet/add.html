{% extends "template.html" %}
{% load i18n %}
{% load filters %}
{% block title %} - Add new pattern{% endblock %}

{% block css %} 
<link rel="stylesheet" href="{{ STATIC_URL }}css/add.css" type="text/css">
<script language="Javascript" type="text/javascript">
var counter = 1;
var limit = 30;
function addInput(divColor){
	if (counter == limit)  {
		alert("You have reached the limit of adding " + counter + " inputs");
	}
	else {
		var el = $("<select id='color"+(counter)+"' name='color"+(counter) +"' onchange='setColor(this.options[this.selectedIndex].value, this)'>");
		var colors = {{ colors|safe }};
		for (i=0;i<=colors.length-1;i++)
		{
			$("<option value='"+colors[i]+"' style='background-color:"+colors[i]+"'>                  </option>").appendTo(el);
		}
		$("#"+divColor).append(el);
		counter++;
		
	}
}

function removeInput() {
	if(counter>1) {
		element = document.getElementById("color"+(counter-1));
		element.parentNode.removeChild(element);
		counter--;
	}
}

function setColor(color, selectbox) {
	selectbox.style.background = ''+color+'';
}
</script>
{% endblock %}


{% block content %}
	<form action="addpattern" method="post" id="addbracelet">
	{% csrf_token %}
	<table>
		<tr>
			<td>{% trans "Name" %}: </td>
			<td><input type="text" name="name" class="tableinput"></td>
		</tr>
		<tr>
			<td>{% trans "Difficulty" %}: </td>
			<td><select name="difficulty" class="tableinput">
			<option value="1" {% if difficulty == "1" %}selected="selected" {% endif %}>{% trans "Easy" %}</option>
			<option value="2" {% if difficulty == "2" %}selected="selected" {% endif %}>{% trans "Medium" %}</option>
			<option value="3" {% if difficulty == "3" %}selected="selected" {% endif %}>{% trans "Hard" %}</option>
			</select>
			</td>
		</tr>
		<tr>
			<td>{% trans "Category" %}:</td>
			<td><select name="category" class="tableinput">
				{% if categories %}
					{% for c in categories %}
						<option {% if category == c.name %}selected="selected" {% endif %}>{{ c.name }}</option>
					{% endfor %}
					</select>
				{% endif %}
				</select>
			</td>
		</tr>
	</table>
	{% trans "Set color of strings (use buttons below to add and remove strings)" %}: <br />
	<span id="colorsInput">
        {% if colors %}
		<select id="color0" name="color0" onchange='setColor(this.options[this.selectedIndex].value, this)'>
		{% for c in colors %}
			<option value="{{ c }}" style="background-color:{{ c }}" {% if c == color %}selected="selected" {% endif %}>                  </option>
		{% endfor %}
		</select>
	{% endif %}  
    </span>
    <br />
    <input type="button" value='{% trans "Add string" %}' onClick="addInput('colorsInput');">
    <input type="button" value='{% trans "Remove string" %}' onClick="removeInput();"><br />
	<textarea rows="20" cols="100" name="pattern"></textarea>
	<input type="submit" value='{% trans "Add pattern" %}'>
</form>
{% endblock %}